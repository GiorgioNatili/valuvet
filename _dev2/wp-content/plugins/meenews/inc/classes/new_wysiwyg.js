(function(b){function n(){this.controls={bold:{groupIndex:0,visible:true,tags:["b","strong"],css:{fontWeight:"bold"},tooltip:"Bold",hotkey:{ctrl:1,key:66}},copy:{groupIndex:8,visible:false,tooltip:"Copy"},createLink:{groupIndex:6,visible:true,exec:function(){var a=this;if(b.wysiwyg.controls&&b.wysiwyg.controls.link)b.wysiwyg.controls.link.init(this);else b.wysiwyg.autoload?b.wysiwyg.autoload.control("wysiwyg.link.js",function(){a.controls.createLink.exec.apply(a)}):g.error("$.wysiwyg.controls.link not defined. You need to include wysiwyg.link.js file")},
tags:["a"],tooltip:"Create link"},cut:{groupIndex:8,visible:false,tooltip:"Cut"},decreaseFontSize:{groupIndex:9,visible:false,tags:["small"],tooltip:"Decrease font size"},h1:{groupIndex:7,visible:true,className:"h1",command:b.browser.msie||b.browser.safari?"FormatBlock":"heading",arguments:b.browser.msie||b.browser.safari?"<h1>":"h1",tags:["h1"],tooltip:"Header 1"},h2:{groupIndex:7,visible:true,className:"h2",command:b.browser.msie||b.browser.safari?"FormatBlock":"heading",arguments:b.browser.msie||
b.browser.safari?"<h2>":"h2",tags:["h2"],tooltip:"Header 2"},h3:{groupIndex:7,visible:true,className:"h3",command:b.browser.msie||b.browser.safari?"FormatBlock":"heading",arguments:b.browser.msie||b.browser.safari?"<h3>":"h3",tags:["h3"],tooltip:"Header 3"},html:{groupIndex:10,visible:false,exec:function(){if(this.viewHTML){this.setContent(b(this.original).val());b(this.original).hide();this.editor.show()}else{this.saveContent();b(this.original).css({width:this.element.outerWidth()-6,height:this.element.height()-
this.ui.toolbar.height()-6,resize:"none"}).show();this.editor.hide()}this.viewHTML=!this.viewHTML},tooltip:"View source code"},increaseFontSize:{groupIndex:9,visible:false,tags:["big"],tooltip:"Increase font size"},indent:{groupIndex:2,visible:true,tooltip:"Indent"},insertHorizontalRule:{groupIndex:6,visible:true,tags:["hr"],tooltip:"Insert Horizontal Rule"},insertImage:{groupIndex:6,visible:true,exec:function(){var a=this;if(b.wysiwyg.controls&&b.wysiwyg.controls.image)b.wysiwyg.controls.image.init(this);
else b.wysiwyg.autoload?b.wysiwyg.autoload.control("wysiwyg.image.js",function(){a.controls.insertImage.exec.apply(a)}):g.error("$.wysiwyg.controls.image not defined. You need to include wysiwyg.image.js file")},tags:["img"],tooltip:"Insert image"},insertOrderedList:{groupIndex:5,visible:true,tags:["ol"],tooltip:"Insert Ordered List"},insertTable:{groupIndex:6,visible:true,exec:function(){var a=this;if(b.wysiwyg.controls&&b.wysiwyg.controls.table)b.wysiwyg.controls.table(this);else b.wysiwyg.autoload?
b.wysiwyg.autoload.control("wysiwyg.table.js",function(){a.controls.insertTable.exec.apply(a)}):g.error("$.wysiwyg.controls.table not defined. You need to include wysiwyg.table.js file")},tags:["table"],tooltip:"Insert table"},insertUnorderedList:{groupIndex:5,visible:true,tags:["ul"],tooltip:"Insert Unordered List"},italic:{groupIndex:0,visible:true,tags:["i","em"],css:{fontStyle:"italic"},tooltip:"Italic",hotkey:{ctrl:1,key:73}},justifyCenter:{groupIndex:1,visible:true,tags:["center"],css:{textAlign:"center"},
tooltip:"Justify Center"},justifyFull:{groupIndex:1,visible:true,css:{textAlign:"justify"},tooltip:"Justify Full"},justifyLeft:{visible:true,groupIndex:1,css:{textAlign:"left"},tooltip:"Justify Left"},justifyRight:{groupIndex:1,visible:true,css:{textAlign:"right"},tooltip:"Justify Right"},ltr:{groupIndex:10,visible:false,exec:function(){this.getInternalRange();var a=this.dom.getElement("p");if(!a)return false;b(a).attr("dir","ltr")},tooltip:"Left to Right"},outdent:{groupIndex:2,visible:true,tooltip:"Outdent"},
paste:{groupIndex:8,visible:false,tooltip:"Paste"},redo:{groupIndex:4,visible:true,tooltip:"Redo"},removeFormat:{groupIndex:10,visible:true,exec:function(){this.removeFormat()},tooltip:"Remove formatting"},rtl:{groupIndex:10,visible:false,exec:function(){this.getInternalRange();var a=this.dom.getElement("p");if(!a)return false;b(a).attr("dir","rtl")},tooltip:"Right to Left"},strikeThrough:{groupIndex:0,visible:true,tags:["s","strike"],css:{textDecoration:"line-through"},tooltip:"Strike-through"},
subscript:{groupIndex:3,visible:true,tags:["sub"],tooltip:"Subscript"},superscript:{groupIndex:3,visible:true,tags:["sup"],tooltip:"Superscript"},underline:{groupIndex:0,visible:true,tags:["u"],css:{textDecoration:"underline"},tooltip:"Underline",hotkey:{ctrl:1,key:85}},undo:{groupIndex:4,visible:true,tooltip:"Undo"}};this.defaults={html:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body style="margin: 0px;">INITIAL_CONTENT</body></html>',
debug:false,controls:{},css:{},events:{},autoGrow:false,autoload:{css:["jquery.wysiwyg.css","jquery.wysiwyg.modal.css"]},autoSave:true,brIE:true,formHeight:270,formWidth:440,i18n:false,iFrameClass:null,initialContent:"<p>Initial content</p>",maxHeight:1E4,messages:{nonSelection:"Select the text you wish to link"},toolbarHtml:'<ul role="menu" class="toolbar"></ul>',removeHeadings:false,resizeOptions:false,rmMsWordMarkup:false,rmUnusedControls:false,rmUnwantedBr:true,tableFiller:"Lorem ipsum"};this.availableControlProperties=
["arguments","callback","className","command","css","custom","exec","groupIndex","hotkey","icon","tags","tooltip","visible"];this.element=this.editorDoc=this.editor=null;this.options={};this.savedRange=this.original=null;this.timers=[];this.dom={ie:{parent:null},w3c:{parent:null}};this.dom.parent=this;this.dom.ie.parent=this.dom;this.dom.w3c.parent=this.dom;this.ui={};this.ui.self=this;this.ui.toolbar=null;this.ui.initialHeight=null;this.dom.getAncestor=function(a,c){for(c=c.toLowerCase();a&&"body"!==
a.tagName.toLowerCase();){if(c===a.tagName.toLowerCase())return a;a=a.parentNode}return null};this.dom.getElement=function(a){return window.getSelection?this.w3c.getElement(a):this.ie.getElement(a)};this.dom.ie.getElement=function(a){var c=this.parent,d=c.parent.getInternalSelection(),e=d.createRange();if("Control"===d.type)if(1===e.length)d=e.item(0);else return null;else d=e.parentElement();return c.getAncestor(d,a)};this.dom.w3c.getElement=function(a){var c=this.parent,d=c.parent.getInternalRange(),
e;if(!d)return null;e=d.commonAncestorContainer;if(3===e.nodeType)e=e.parentNode;if(e===d.startContainer)e=e.childNodes[d.startOffset];return c.getAncestor(e,a)};this.ui.addHoverClass=function(){b(this).addClass("wysiwyg-button-hover")};this.ui.appendControls=function(){var a=this,c=this.self.parseControls(),d=true,e=[],f={},h,k=function(j,i){if(i.groupIndex&&h!==i.groupIndex){h=i.groupIndex;d=false}if(i.visible){if(!d){a.appendItemSeparator();d=true}i.custom?a.appendItemCustom(j,i):a.appendItem(j,
i)}};b.each(c,function(j,i){var l="empty";if(undefined!==i.groupIndex)l=""===i.groupIndex?"empty":i.groupIndex;if(undefined===f[l]){e.push(l);f[l]={}}f[l][j]=i});e.sort(function(j,i){if("number"===typeof j&&typeof j===typeof i)return j-i;else{j=""+j;i=""+i;if(j>i)return 1;if(j===i)return 0;return-1}});if(0<e.length)h=e[0];for(c=0;c<e.length;c+=1)b.each(f[e[c]],k)};this.ui.appendItem=function(a,c){var d=this.self,e=c.className||c.command||a||"empty",f=c.tooltip||c.command||a||"";if(b.wysiwyg.i18n)f=
b.wysiwyg.i18n.t(f,"controls");return b('<li role="menuitem" unselectable="on">'+e+"</li>").addClass(e).attr("title",f).hover(this.addHoverClass,this.removeHoverClass).click(function(){d.triggerControl.apply(d,[a,c]);this.blur();d.ui.returnRange();d.ui.focus()}).appendTo(d.ui.toolbar)};this.ui.appendItemCustom=function(a,c){var d=this.self,e=c.tooltip||c.command||a||"";if(b.wysiwyg.i18n)e=b.wysiwyg.i18n.t(e,"controls");c.callback&&b(window).bind("trigger-"+a+".wysiwyg",c.callback);return b('<li role="menuitem" unselectable="on" style="background: url(\''+
c.icon+"') no-repeat;\"></li>").addClass("custom-command-"+a).addClass("wysiwyg-custom-command").addClass(a).attr("title",c.tooltip).hover(this.addHoverClass,this.removeHoverClass).click(function(){d.triggerControl.apply(d,[a,c]);this.blur();d.ui.returnRange();d.ui.focus();d.triggerControlCallback(a)}).appendTo(d.ui.toolbar)};this.ui.appendItemSeparator=function(){var a=this.self;return b('<li role="separator" class="separator"></li>').appendTo(a.ui.toolbar)};this.autoSaveFunction=function(){this.saveContent()};
this.ui.checkTargets=function(a){var c=this.self;b.each(c.options.controls,function(d,e){var f=e.className||e.command||d||"empty",h,k,j,i=function(l,m){if("function"===typeof m)m(j.css(l).toString().toLowerCase(),c)&&b("."+f,c.ui.toolbar).addClass("active");else j.css(l).toString().toLowerCase()===m&&b("."+f,c.ui.toolbar).addClass("active")};b("."+f,c.ui.toolbar).removeClass("active");if(e.tags||e.options&&e.options.tags){h=e.tags||e.options&&e.options.tags;for(k=a;k;){if(k.nodeType!==1)break;b.inArray(k.tagName.toLowerCase(),
h)!==-1&&b("."+f,c.ui.toolbar).addClass("active");k=k.parentNode}}if(e.css||e.options&&e.options.css){h=e.css||e.options&&e.options.css;for(j=b(a);j;){if(j[0].nodeType!==1)break;b.each(h,i);j=j.parent()}}})};this.ui.designMode=function(){var a=this.self,c=function(d){if("on"===a.editorDoc.designMode){a.timers.designMode&&window.clearTimeout(a.timers.designMode);a.innerDocument()!==a.editorDoc&&a.ui.initFrame()}else{try{a.editorDoc.designMode="on"}catch(e){}d-=1;if(d>0)a.timers.designMode=window.setTimeout(function(){c(d)},
100)}};c(3)};this.destroy=function(){var a,c=this.element.closest("form");for(a=0;a<this.timers.length;a+=1)window.clearTimeout(this.timers[a]);c.unbind(".wysiwyg");this.element.remove();b.removeData(this.original,"wysiwyg");b(this.original).show();return this};this.getRangeText=function(){var a=this.getInternalRange();if(a.toString)a=a.toString();else if(a.text)a=a.text;return a};this.execute=function(a,c){if(typeof c==="undefined")c=null;this.editorDoc.execCommand(a,false,c)};this.extendOptions=
function(a){var c={},d=[];if("object"===typeof a.controls){c=a.controls;delete a.controls}a=b.extend(true,{},this.defaults,a);a.controls=b.extend(true,this.controls,c);if(a.rmUnusedControls){b.each(a.controls,function(e){c[e]||d.push(e)});b.each(d,function(e){delete a.controls[d[e]]})}return a};this.ui.focus=function(){var a=this.self;a.editor.get(0).contentWindow.focus();return a};this.ui.returnRange=function(){var a=this.self,c;if(a.savedRange!==null){if(window.getSelection){c=window.getSelection();
c.rangeCount>0&&c.removeAllRanges();try{c.addRange(a.savedRange)}catch(d){g.error(d)}}else if(window.document.createRange)window.getSelection().addRange(a.savedRange);else window.document.selection&&a.savedRange.select();a.savedRange=null}};this.getContent=function(){return this.editorDoc.body.innerHTML};this.getElementByAttributeValue=function(a,c,d){var e,f=this.editorDoc.getElementsByTagName(a);for(a=0;a<f.length;a+=1){e=f[a].getAttribute(c);if(b.browser.msie)e=e.substr(e.length-d.length);if(e===
d)return f[a]}return false};this.getInternalRange=function(){var a=this.getInternalSelection();if(!a)return null;if(a.rangeCount&&a.rangeCount>0)return a.getRangeAt(0);else if(a.createRange)return a.createRange();return null};this.getInternalSelection=function(){if(this.editor.get(0).contentWindow){if(this.editor.get(0).contentWindow.getSelection)return this.editor.get(0).contentWindow.getSelection();if(this.editor.get(0).contentWindow.selection)return this.editor.get(0).contentWindow.selection}if(this.editorDoc.getSelection)return this.editorDoc.getSelection();
if(this.editorDoc.selection)return this.editorDoc.selection;return null};this.getRange=function(){var a=this.getSelection();if(!a)return null;if(a.rangeCount&&a.rangeCount>0)a.getRangeAt(0);else if(a.createRange)return a.createRange();return null};this.getSelection=function(){return window.getSelection?window.getSelection():window.document.selection};this.ui.grow=function(){var a=this.self,c=b(a.editorDoc.body),d=b.browser.msie?c[0].scrollHeight:c.height()+2+20;d=Math.max(d,a.ui.initialHeight);d=
Math.min(d,a.options.maxHeight);a.editor.attr("scrolling",d<a.options.maxHeight?"no":"auto");c.css("overflow",d<a.options.maxHeight?"hidden":"");a.editor.get(0).height=d;return a};this.init=function(a,c){var d=this,e=b(a).closest("form"),f=a.width||a.clientWidth||0,h=a.height||a.clientHeight||0,k;this.options=this.extendOptions(c);this.original=a;this.ui.toolbar=b(this.options.toolbarHtml);if(this.options.autoload)if(b.wysiwyg.autoload)if(this.options.autoload.css)for(k=0;k<this.options.autoload.css.length;k+=
1)b.wysiwyg.autoload.css(this.options.autoload.css[k]);this.options.i18n&&b.wysiwyg.i18n&&b.wysiwyg.i18n.init(this,this.options.i18n);if(b.browser.msie&&parseInt(b.browser.version,10)<8)this.options.autoGrow=false;if(f===0&&a.cols)f=a.cols*8+21;if(h===0&&a.rows)h=a.rows*16+16;this.editor=b(window.location.protocol==="https:"?'<iframe src="javascript:false;"></iframe>':"<iframe></iframe>").attr("frameborder","0");if(this.options.iFrameClass)this.editor.addClass(this.options.iFrameClass);else{this.editor.css({minHeight:(h-
6).toString()+"px",width:f>50?(f-8).toString()+"px":""});b.browser.msie&&parseInt(b.browser.version,10)<7&&this.editor.css("height",h.toString()+"px")}this.editor.attr("tabindex",b(a).attr("tabindex"));this.element=b("<div/>").addClass("wysiwyg");this.options.iFrameClass||this.element.css({width:f>0?f.toString()+"px":"100%"});b(a).hide().before(this.element);this.viewHTML=false;this.initialContent=b(a).val();this.ui.initFrame();this.options.resizeOptions&&b.fn.resizable&&this.element.resizable(b.extend(true,
{alsoResize:this.editor},this.options.resizeOptions));this.options.autoSave&&e.bind("submit.wysiwyg",function(){d.autoSaveFunction()});e.bind("reset.wysiwyg",function(){d.resetFunction()})};this.ui.initFrame=function(){var a=this.self,c;a.ui.appendControls();a.element.append(a.ui.toolbar).append(b("<div><\!-- --\></div>").css({clear:"both"})).append(a.editor);a.editorDoc=a.innerDocument();a.ui.designMode();a.editorDoc.open();a.editorDoc.write(a.options.html.replace(/INITIAL_CONTENT/,function(){return a.wrapInitialContent()}));
a.editorDoc.close();if(b.browser.msie)a.timers.initFrame_IeBorder=window.setTimeout(function(){b(a.editorDoc.body).css("border","none")},0);b(a.editorDoc).bind("click.wysiwyg",function(d){a.ui.checkTargets(d.target?d.target:d.srcElement)});b(a.original).focus(function(){b(this).filter(":visible")||a.ui.focus()});b(a.editorDoc).keydown(function(d){var e=/^<([\w]+)[^>]*>(<br\/?>)?<\/\1>/;if(d.keyCode===8)if(e.test(a.getContent())){d.stopPropagation();return false}return true});if(b.browser.msie)a.options.brIE&&
b(a.editorDoc).keydown(function(d){if(d.keyCode===13){d=a.getRange();d.pasteHTML("<br/>");d.collapse(false);d.select();return false}return true});else b(a.editorDoc).keydown(function(d){var e;if(d.ctrlKey||d.metaKey)for(e in a.controls)if(a.controls[e].hotkey&&a.controls[e].hotkey.ctrl)if(d.keyCode===a.controls[e].hotkey.key){a.triggerControl.apply(a,[e,a.controls[e]]);return false}return true});a.options.rmMsWordMarkup&&b(a.editorDoc).bind("keyup.wysiwyg",function(d){if(d.ctrlKey||d.metaKey)if(86===
d.keyCode)if(a.options.rmMsWordMarkup)if(b.wysiwyg.rmFormat)"object"===typeof a.options.rmMsWordMarkup?b.wysiwyg.rmFormat.run(a,{rules:{msWordMarkup:a.options.rmMsWordMarkup}}):b.wysiwyg.rmFormat.run(a,{rules:{msWordMarkup:{enabled:true}}})});if(a.options.autoSave)b(a.editorDoc).keydown(function(){a.autoSaveFunction()}).keyup(function(){a.autoSaveFunction()}).mousedown(function(){a.autoSaveFunction()}).bind(b.support.noCloneEvent?"input.wysiwyg":"paste.wysiwyg",function(){a.autoSaveFunction()});if(a.options.autoGrow){a.ui.initialHeight=
b(a.editorDoc).height();b(a.editorDoc.body).css("border","1px solid white");c=function(){a.ui.grow()};b(a.editorDoc).keyup(c);b(a.editorDoc).bind("wysiwyg:refresh",c);a.ui.grow()}if(a.options.css)if(String===a.options.css.constructor)if(b.browser.msie){c=a.editorDoc.createStyleSheet(a.options.css);b(c).attr({media:"all"})}else{c=b("<link/>").attr({href:a.options.css,media:"all",rel:"stylesheet",type:"text/css"});b(a.editorDoc).find("head").append(c)}else a.timers.initFrame_Css=window.setTimeout(function(){b(a.editorDoc.body).css(a.options.css)},
0);if(a.initialContent.length===0)"function"===typeof a.options.initialContent?a.setContent(a.options.initialContent()):a.setContent(a.options.initialContent);b.each(a.options.events,function(d,e){b(a.editorDoc).bind(d+".wysiwyg",e)});b.browser.msie?b(a.editorDoc).bind("beforedeactivate.wysiwyg",function(){a.savedRange=a.getInternalRange()}):b(a.editorDoc).bind("blur.wysiwyg",function(){a.savedRange=a.getInternalRange()});b(a.editorDoc.body).addClass("wysiwyg");if(a.options.events&&a.options.events.save){c=
a.options.events.save;b(a.editorDoc).bind("keyup.wysiwyg",c);b(a.editorDoc).bind("change.wysiwyg",c);if(b.support.noCloneEvent)b(a.editorDoc).bind("input.wysiwyg",c);else{b(a.editorDoc).bind("paste.wysiwyg",c);b(a.editorDoc).bind("cut.wysiwyg",c)}}};this.innerDocument=function(){var a=this.editor.get(0);if(a.nodeName.toLowerCase()==="iframe"){if(a.contentDocument)return a.contentDocument;else if(a.contentWindow)return a.contentWindow.document;g.error("Unexpected error in innerDocument")}return a};
this.insertHtml=function(a){var c;if(!a||a.length===0)return this;if(b.browser.msie){this.ui.focus();this.editorDoc.execCommand("insertImage",false,"#jwysiwyg#");(c=this.getElementByAttributeValue("img","src","#jwysiwyg#"))&&b(c).replaceWith(a)}else this.editorDoc.execCommand("insertHTML",false,a);return this};this.parseControls=function(){var a=this;b.each(this.options.controls,function(c,d){b.each(d,function(e){if(-1===b.inArray(e,a.availableControlProperties))throw c+'["'+e+'"]: property "'+e+
'" not exists in Wysiwyg.availableControlProperties';})});if(this.options.parseControls)return this.options.parseControls.call(this);return this.options.controls};this.removeFormat=function(){b.browser.msie&&this.ui.focus();this.options.removeHeadings&&this.editorDoc.execCommand("formatBlock",false,"<p>");this.editorDoc.execCommand("removeFormat",false,null);this.editorDoc.execCommand("unlink",false,null);b.wysiwyg.rmFormat&&b.wysiwyg.rmFormat.enabled&&b.wysiwyg.rmFormat.run(this);return this};this.ui.removeHoverClass=
function(){b(this).removeClass("wysiwyg-button-hover")};this.resetFunction=function(){this.setContent(this.initialContent);this.saveContent()};this.saveContent=function(){if(this.original){var a;this.viewHTML&&this.setContent(b(this.original).val());a=this.getContent();if(this.options.rmUnwantedBr)a=a.replace(/<br\/?>$/,"");b(this.original).val(a);this.options.events&&this.options.events.save&&this.options.events.save.call(this)}return this};this.setContent=function(a){a=b("<div/>").addClass("temp").append(a);
a.children("div").each(function(){var c=b(this),d=c.find("p"),e;if(0===d.length){d=b("<p></p>");if(this.attributes.length>0)for(e=0;e<this.attributes.length;e+=1)d.attr(this.attributes[e].name,c.attr(this.attributes[e].name));d.append(c.html());c.replaceWith(d)}});this.editorDoc.body.innerHTML=a.html();return this};this.triggerControl=function(a,c){var d=c.command||a,e=c.arguments||[];if(c.exec)c.exec.apply(this);else{this.ui.focus();this.ui.withoutCss();try{this.editorDoc.execCommand(d,false,e)}catch(f){g.error(f)}}this.options.autoSave&&
this.autoSaveFunction()};this.triggerControlCallback=function(a){b(window).trigger("trigger-"+a+".wysiwyg",[this])};this.ui.withoutCss=function(){var a=this.self;if(b.browser.mozilla)try{a.editorDoc.execCommand("styleWithCSS",false,false)}catch(c){try{a.editorDoc.execCommand("useCSS",false,true)}catch(d){}}return a};this.wrapInitialContent=function(){var a=this.initialContent;if(!a.match(/<\/?p>/gi))return"<p>"+a+"</p>";return a}}var g=window.console?window.console:{log:b.noop,error:function(a){b.error(a)}};
b.wysiwyg={addControl:function(a,c,d){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var e=b(this).data("wysiwyg"),f={};if(!e)return this;f[c]=b.extend(true,{visible:true,custom:true},d);b.extend(true,e.controls,f);f=b(e.options.toolbarHtml);e.ui.toolbar.replaceWith(f);e.ui.toolbar=f;e.ui.appendControls()})},clear:function(a){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var c=
b(this).data("wysiwyg");if(!c)return this;c.setContent("");c.saveContent()})},console:g,destroy:function(a){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var c=b(this).data("wysiwyg");if(!c)return this;c.destroy()})},document:function(a){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");if(a=a.data("wysiwyg"))return b(a.editorDoc)},getContent:function(a){if("object"!==typeof a||
!a.context)a=this;a.each||g.error("Something goes wrong, check object");if(a=a.data("wysiwyg"))return a.getContent()},init:function(a,c){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var d=b.extend(true,{},c),e;if(!("textarea"!==this.nodeName.toLowerCase()||b(this).data("wysiwyg"))){e=new n;e.init(this,d);b.data(this,"wysiwyg",e)}})},insertHtml:function(a,c){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");
return a.each(function(){var d=b(this).data("wysiwyg");if(!d)return this;d.insertHtml(c)})},plugin:{exists:function(a){if("string"!==typeof a)return false;a=this.parseName(a);if(!b.wysiwyg[a.name])return false;if(!b.wysiwyg[a.name][a.method])return false;return true},parseName:function(a){if("string"!==typeof a)return false;a=a.split(".");if(2>a.length)return false;return{name:a[0],method:a[1]}},register:function(a){a.name||g.error("Plugin name missing");b.each(b.wysiwyg,function(c){c===a.name&&g.error("Plugin with name '"+
a.name+"' was already registered")});b.wysiwyg[a.name]=a;return true}},removeFormat:function(a){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var c=b(this).data("wysiwyg");if(!c)return this;c.removeFormat()})},save:function(a){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var c=b(this).data("wysiwyg");if(!c)return this;c.saveContent()})},setContent:function(a,
c){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var d=b(this).data("wysiwyg");if(!d)return this;d.setContent(c);d.saveContent()})},triggerControl:function(a,c){if("object"!==typeof a||!a.context)a=this;a.each||g.error("Something goes wrong, check object");return a.each(function(){var d=b(this).data("wysiwyg");if(!d)return this;d.controls[c]||g.error("Control '"+c+"' not exists");d.triggerControl.apply(d,[c,d.controls[c]])})},
utils:{extraSafeEntities:[["<",">","'",'"'," "],[32]],encodeEntities:function(a){var c=this,d,e=[];this.extraSafeEntities[1].length===0&&b.each(this.extraSafeEntities[0],function(f,h){c.extraSafeEntities[1].push(h.charCodeAt())});d=a.split("");b.each(d,function(f){var h=d[f].charCodeAt();b.inArray(h,c.extraSafeEntities[1])&&(h<65||h>127||h>90&&h<97)?e.push("&#"+h+";"):e.push(d[f])});return e.join("")}}};b.fn.wysiwyg=function(a){var c=arguments,d;if("undefined"!==typeof b.wysiwyg[a]){c=Array.prototype.concat.call([c[0]],
[undefined],Array.prototype.slice.call(c,1));return b.wysiwyg[a].apply(this,Array.prototype.slice.call(c,1))}else if("object"===typeof a||!a){Array.prototype.unshift.call(c,undefined);return b.wysiwyg.init.apply(this,c)}else if(b.wysiwyg.plugin.exists(a)){d=b.wysiwyg.plugin.parseName(a);c=Array.prototype.concat.call([c[0]],[undefined],Array.prototype.slice.call(c,1));return b.wysiwyg[d.name][d.method].apply(this,Array.prototype.slice.call(c,1))}else g.error("Method '"+a+"' does not exist on jQuery.wysiwyg.\nTry to include some extra controls or plugins")}})(jQuery);
(function(b){b.fn.qr_wysiwyg=function(){this.each(function(n,g){b(g).wysiwyg({autoGrow:true,autoload:false,initialContent:"<p>&nbsp;</p>",css:(window.MEDIA_URL?window.MEDIA_URL:"")+"css/wysiwyg/jquery.wysiwyg.editor.css",rmUnusedControls:true,controls:{undo:{visible:true,groupIndex:1},redo:{visible:true,groupIndex:1},bold:{visible:true,groupIndex:2},italic:{visible:true,groupIndex:2},strikeThrough:{visible:true,groupIndex:2},underline:{visible:true,groupIndex:2},justifyCenter:{visible:true,groupIndex:3},
justifyFull:{visible:true,groupIndex:3},justifyLeft:{visible:true,groupIndex:3},justifyRight:{visible:true,groupIndex:3},indent:{visible:true,groupIndex:4},outdent:{visible:true,groupIndex:4},subscript:{visible:true,groupIndex:5},superscript:{visible:true,groupIndex:5},insertOrderedList:{visible:true,groupIndex:6},insertUnorderedList:{visible:true,groupIndex:6},removeFormat:{visible:true,groupIndex:7}}})})}})(jQuery);